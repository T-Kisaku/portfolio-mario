(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,function(t,e,n){"use strict";n.r(e);var r=n(3),o=n.n(r);function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pos=e,this.size=n,this.offset=r}var e,n,r;return e=t,(n=[{key:"overlaps",value:function(t){return this.bottom>t.top&&this.top<t.bottom&&this.left<t.right&&this.right>t.left}},{key:"bottom",get:function(){return this.pos.y+this.size.y+this.offset.y},set:function(t){this.pos.y=t-(this.size.y+this.offset.y)}},{key:"top",get:function(){return this.pos.y+this.offset.y},set:function(t){this.pos.y=t-this.offset.y}},{key:"left",get:function(){return this.pos.x+this.offset.x},set:function(t){this.pos.x=t-this.offset.x}},{key:"right",get:function(){return this.pos.x+this.size.x+this.offset.x},set:function(t){this.pos.x=t-(this.size.x+this.offset.x)}}])&&i(e.prototype,n),r&&i(e,r),t}();function u(t){return function(t){if(Array.isArray(t))return f(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||c(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){if(t){if("string"===typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.events=[]}var e,n,r;return e=t,(n=[{key:"emit",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];this.events.push({name:t,args:n})}},{key:"process",value:function(t,e){var n,r=function(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=c(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}(this.events);try{for(r.s();!(n=r.n()).done;){var o=n.value;o.name===t&&e.apply(void 0,u(o.args))}}catch(i){r.e(i)}finally{r.f()}}},{key:"clear",value:function(){this.events.length=0}}])&&l(e.prototype,n),r&&l(e,r),t}();function y(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(c){o=!0,i=c}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||h(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=h(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function h(t,e){if(t){if("string"===typeof t)return v(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(t,e):void 0}}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function m(t,e,n){return e&&b(t.prototype,e),n&&b(t,n),t}var w=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;d(this,t),this.x=e,this.y=n}return m(t,[{key:"set",value:function(t,e){this.x=t,this.y=e}},{key:"copy",value:function(t){this.set(t.x,t.y)}}]),t}(),g=function(){function t(){d(this,t),this.grid=[]}return m(t,[{key:"set",value:function(t,e,n){this.grid[t]||(this.grid[t]=[]),this.grid[t][e]=n}},{key:"get",value:function(t,e){var n=this.grid[t];if(n)return n[e]}},{key:"delete",value:function(t,e){var n=this.grid[t];n&&delete n[e]}},{key:"itemsInRange",value:o.a.mark((function t(e,n,r,i){var a,u,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e;case 1:if(!(a<=r)){t.next=14;break}u=n;case 3:if(!(u<=i)){t.next=11;break}if(!(c=this.get(a,u))){t.next=8;break}return t.next=8,[c,a,u];case 8:u++,t.next=3;break;case 11:a++,t.next=1;break;case 14:case"end":return t.stop()}}),t,this)}))},{key:"forEach",value:function(t){var e,n=p(this.grid.entries());try{for(n.s();!(e=n.n()).done;){var r,o=y(e.value,2),i=o[0],a=p(o[1].entries());try{for(a.s();!(r=a.n()).done;){var u=y(r.value,2),c=u[0];t(u[1],i,c)}}catch(f){a.e(f)}finally{a.f()}}}catch(f){n.e(f)}finally{n.f()}}}]),t}();function S(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"===typeof t)return O(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function k(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var x,T=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.listeners=[]}var e,n,r;return e=t,(n=[{key:"listen",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;this.listeners.push({name:t,callback:e,count:n})}},{key:"queue",value:function(e){this.listen(t.EVENT_TASK,e,1)}},{key:"finalize",value:function(t){var e,n=S(this.listeners);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.events.process(r.name,r.callback),r.count-=1}}catch(o){n.e(o)}finally{n.f()}this.listeners=this.listeners.filter((function(t){return t.count>0}))}},{key:"update",value:function(t,e,n){}},{key:"obstruct",value:function(t,e,n){}},{key:"collides",value:function(t,e){}}])&&k(e.prototype,n),r&&k(e,r),t}();function j(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}T.EVENT_TASK=Symbol("task"),function(t){t[t.top=0]="top",t[t.bottom=1]="bottom",t[t.left=2]="left",t[t.right=3]="right"}(x||(x={}));var E=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pos=new w,this.vel=new w,this.size=new w,this.offset=new w,this.bounds=new a(this.pos,this.size,this.offset),this.traits=new Map,this.lifetime=0,this.sounds=new Set,this.events=new s}var e,n,r;return e=t,(n=[{key:"addTrait",value:function(t){return this.traits.set(t.constructor,t),t}},{key:"getTrait",value:function(t){var e=this.traits.get(t);if(e instanceof t)return e}},{key:"useTrait",value:function(t,e){var n=this.getTrait(t);n&&e(n)}},{key:"update",value:function(t,e){var n=this;this.traits.forEach((function(r){r.update(n,t,e)})),this.audio&&this.playSounds(this.audio,t.audioContext),this.lifetime+=t.deltaTime}},{key:"draw",value:function(t){}},{key:"finalize",value:function(){var t=this;this.events.emit(T.EVENT_TASK,this),this.traits.forEach((function(e){e.finalize(t)})),this.events.clear()}},{key:"obstruct",value:function(t,e){var n=this;this.traits.forEach((function(r){r.obstruct(n,t,e)}))}},{key:"collides",value:function(t){var e=this;this.traits.forEach((function(n){n.collides(e,t)}))}},{key:"playSounds",value:function(t,e){this.sounds.forEach((function(n){return t.play(n,e)})),this.sounds.clear()}}])&&j(e.prototype,n),r&&j(e,r),t}();function A(t,e){return function(n){var r=Math.floor(n/e%t.length);return t[r]}}function _(t){return new Promise((function(e,n){var r=new Image;r.addEventListener("load",(function(){e(r)})),r.addEventListener("error",(function(){n("Could not load image from ".concat(t))})),r.src=t}))}function P(t){return fetch(t).then((function(t){return t.json()}))}function R(t){throw new Error(t)}function I(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var C=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.image=e,this.tileWidth=n,this.tileHeight=r,this.tiles=new Map,this.animations=new Map}var e,n,r;return e=t,(n=[{key:"define",value:function(t,e,n,r,o,i,a){var u=this,c=[!1,!0].map((function(t){var c=document.createElement("canvas"),f=i&&i||r,l=a&&a||o;c.width=f,c.height=l;var s=c.getContext("2d")||R("Canvas not supported");return t&&(s.scale(-1,1),s.translate(-f,0)),s.drawImage(u.image,e,n,r,o,0,0,f,l),c}));this.tiles.set(t,c)}},{key:"defineTile",value:function(t,e,n){this.define(t,e*this.tileWidth,n*this.tileHeight,this.tileWidth,this.tileHeight)}},{key:"defineAnimation",value:function(t,e){this.animations.set(t,e)}},{key:"draw",value:function(t,e,n,r){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=this.tiles.get(t);if(!i)throw new Error('SpriteSheet.draw(): Sprite "'.concat(t,'" not found'));e.drawImage(i[o?1:0],n,r)}},{key:"drawTile",value:function(t,e,n,r){this.draw(t,e,n*this.tileWidth,r*this.tileHeight)}},{key:"drawAnimation",value:function(t,e,n,r,o){var i=this.animations.get(t);if(!i)throw new Error("Animation not found: ".concat(t));this.drawTile(i(o),e,n,r)}},{key:"getAnimation",value:function(t){var e=this.animations.get(t);if(!e)throw new Error("Animation not found: ".concat(t));return e}}])&&I(e.prototype,n),r&&I(e,r),t}();function M(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(c){o=!0,i=c}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"===typeof t)return D(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function L(t,e,n,r,o,i,a){try{var u=t[i](a),c=u.value}catch(f){return void n(f)}u.done?e(c):Promise.resolve(c).then(r,o)}function z(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){L(i,r,o,a,u,"next",t)}function u(t){L(i,r,o,a,u,"throw",t)}a(void 0)}))}}function N(t,e,n){return U.apply(this,arguments)}function U(){return(U=z(o.a.mark((function t(e,n,r){var i,a,u,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i="sprites/".concat(e,".json"),t.next=3,P(i);case 3:return a=t.sent,t.next=6,_(a.imageURL);case 6:return u=t.sent,c=new C(u,a.tileW,a.tileH),a.tiles&&a.tiles.forEach((function(t){var e=M(t.index,2),n=e[0],r=e[1];c.defineTile(t.name,n,r)})),a.frames&&a.frames.forEach((function(t){var e=M(t.rect,4),o=e[0],i=e[1],a=e[2],u=e[3];c.define(t.name,o,i,a,u,n,r)})),a.animations&&a.animations.forEach((function(t){var e=A(t.frames,t.frameLength);c.defineAnimation(t.name,e)})),t.abrupt("return",c);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function $(t){return($="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function F(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function V(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function G(t,e){return(G=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function q(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=B(t);if(e){var o=B(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Y(this,n)}}function Y(t,e){return!e||"object"!==$(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function B(t){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var H=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&G(t,e)}(i,t);var e,n,r,o=q(i);function i(){return F(this,i),o.apply(this,arguments)}return e=i,(n=[{key:"update",value:function(t,e,n){var r=e.deltaTime;t.vel.y+=n.gravity*r}}])&&V(e.prototype,n),r&&V(e,r),i}(T);function K(t){return(K="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function W(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function X(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function J(t,e){return(J=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Z(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=tt(t);if(e){var o=tt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Q(this,n)}}function Q(t,e){return!e||"object"!==K(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function tt(t){return(tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var et=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&J(t,e)}(i,t);var e,n,r,o=Z(i);function i(){var t;W(this,i);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=o.call.apply(o,[this].concat(n))).dead=!1,t.deadTime=0,t.removeAfter=2,t}return e=i,(n=[{key:"kill",value:function(){var t=this;this.queue((function(){t.dead=!0}))}},{key:"revive",value:function(){this.dead=!1,this.deadTime=0}},{key:"update",value:function(t,e,n){var r=e.deltaTime;this.dead&&(this.deadTime+=r,this.deadTime>this.removeAfter&&this.queue((function(){n.entities.delete(t)})))}}])&&X(e.prototype,n),r&&X(e,r),i}(T);function nt(t){return(nt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ot(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function it(t,e){return(it=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function at(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ct(t);if(e){var o=ct(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ut(this,n)}}function ut(t,e){return!e||"object"!==nt(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ct(t){return(ct=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ft=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&it(t,e)}(i,t);var e,n,r,o=at(i);function i(){var t;rt(this,i);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=o.call.apply(o,[this].concat(n))).bounceSpeed=400,t}return e=i,(n=[{key:"bounce",value:function(t,e){t.bounds.bottom=e.bounds.top,t.vel.y=-this.bounceSpeed}},{key:"collides",value:function(t,e){var n=this,r=e.getTrait(et);r&&!r.dead&&t.vel.y>e.vel.y&&(this.queue((function(){return n.bounce(t,e)})),t.sounds.add("stomp"),t.events.emit(i.EVENT_STOMP,t,e))}}])&&ot(e.prototype,n),r&&ot(e,r),i}(T);function lt(t){return(lt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function st(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function pt(t,e){return(pt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ht(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=dt(t);if(e){var o=dt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vt(this,n)}}function vt(t,e){return!e||"object"!==lt(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function dt(t){return(dt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}ft.EVENT_STOMP=Symbol("stomp");var bt=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pt(t,e)}(i,t);var e,n,r,o=ht(i);function i(){return st(this,i),o.apply(this,arguments)}return e=i,(n=[{key:"update",value:function(t,e){var n=e.deltaTime;t.pos.x+=t.vel.x*n,t.pos.y+=t.vel.y*n}}])&&yt(e.prototype,n),r&&yt(e,r),i}(T);function mt(t,e,n,r,o,i,a){try{var u=t[i](a),c=u.value}catch(f){return void n(f)}u.done?e(c):Promise.resolve(c).then(r,o)}function wt(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){mt(i,r,o,a,u,"next",t)}function u(t){mt(i,r,o,a,u,"throw",t)}a(void 0)}))}}function gt(t){return(gt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function St(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ot(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function kt(t,e){return(kt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function xt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=jt(t);if(e){var o=jt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Tt(this,n)}}function Tt(t,e){return!e||"object"!==gt(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jt(t){return(jt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Et=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&kt(t,e)}(i,t);var e,n,r,o=xt(i);function i(){var t;St(this,i);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=o.call.apply(o,[this].concat(n))).gravity=new H,t}return e=i,(n=[{key:"collides",value:function(t,e){var n,r,o;(null===(n=t.getTrait(et))||void 0===n?void 0:n.dead)||e.getTrait(ft)&&(e.vel.y>t.vel.y?(null===(r=t.getTrait(et))||void 0===r||r.kill(),t.vel.set(100,-200)):null===(o=e.getTrait(et))||void 0===o||o.kill())}},{key:"update",value:function(t,e,n){var r;(null===(r=t.getTrait(et))||void 0===r?void 0:r.dead)&&this.gravity.update(t,e,n)}}])&&Ot(e.prototype,n),r&&Ot(e,r),i}(T);function At(){return _t.apply(this,arguments)}function _t(){return(_t=wt(o.a.mark((function t(){var e;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N("bullet");case 2:return e=t.sent,t.abrupt("return",(function(){var t=new E;return t.size.set(16,14),t.vel.set(80,0),t.addTrait(new Et),t.addTrait(new et),t.addTrait(new bt),t.draw=function(n){e.draw("bullet",n,0,0,t.vel.x<0)},t}));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Pt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Rt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.buffers=new Map}var e,n,r;return e=t,(n=[{key:"add",value:function(t,e){this.buffers.set(t,e)}},{key:"play",value:function(t,e){var n=e.createBufferSource();n.connect(e.destination),n.buffer=this.buffers.get(t),n.start(0)}}])&&Pt(e.prototype,n),r&&Pt(e,r),t}();function It(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(c){o=!0,i=c}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"===typeof t)return Ct(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ct(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ct(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Mt(t,e,n,r,o,i,a){try{var u=t[i](a),c=u.value}catch(f){return void n(f)}u.done?e(c):Promise.resolve(c).then(r,o)}function Dt(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Mt(i,r,o,a,u,"next",t)}function u(t){Mt(i,r,o,a,u,"throw",t)}a(void 0)}))}}function Lt(t){return function(){var e=Dt(o.a.mark((function e(n){var r,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(n);case 2:return r=e.sent,e.next=5,r.arrayBuffer();case 5:return i=e.sent,e.abrupt("return",t.decodeAudioData(i));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}function zt(t,e){return Nt.apply(this,arguments)}function Nt(){return(Nt=Dt(o.a.mark((function t(e,n){var r,i,a,u;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Lt(n),t.next=3,P("/sounds/".concat(e,".json"));case 3:return i=t.sent,a=new Rt,u=Object.entries(i.fx).map((function(t){var e=It(t,2),n=e[0],o=e[1].url;return r(o).then((function(t){return a.add(n,t)})).catch((function(){return console.error("failed to load ".concat(o))}))})),t.next=8,Promise.all(u);case 8:return t.abrupt("return",a);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ut(t){return(Ut="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ft(t,e){return(Ft=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Vt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=qt(t);if(e){var o=qt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Gt(this,n)}}function Gt(t,e){return!e||"object"!==Ut(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qt(t){return(qt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Yt=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ft(t,e)}(i,t);var e,n,r,o=Vt(i);function i(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).name="UNNAMED",t.coins=0,t.lives=3,t.score=0,t.listen(ft.EVENT_STOMP,(function(){t.score+=100})),t}return e=i,(n=[{key:"addCoins",value:function(t){for(this.coins+=t;this.coins>=100;)this.addLives(1),this.coins-=100;this.queue((function(t){return t.sounds.add("coin")}))}},{key:"addLives",value:function(t){this.lives+=t}}])&&$t(e.prototype,n),r&&$t(e,r),i}(T);function Bt(t){return(Bt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ht(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Kt(t,e){return(Kt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Wt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Jt(t);if(e){var o=Jt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Xt(this,n)}}function Xt(t,e){return!e||"object"!==Bt(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Jt(t){return(Jt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Zt=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Kt(t,e)}(i,t);var e,n,r,o=Wt(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).player=t,e.checkpoint=new w(0,0),e}return e=i,(n=[{key:"update",value:function(t,e,n){var r;n.entities.has(this.player)||(null===(r=this.player.getTrait(et))||void 0===r||r.revive(),this.player.pos.set(this.checkpoint.x,this.checkpoint.y),n.entities.add(this.player))}}])&&Ht(e.prototype,n),r&&Ht(e,r),i}(T),Qt=o.a.mark(re);function te(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"===typeof t)return ee(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ee(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function ee(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ne(t){var e=new E,n=new Zt(t);return n.checkpoint.set(64,64),e.addTrait(n),e}function re(t){var e,n,r;return o.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:e=te(t),o.prev=1,e.s();case 3:if((n=e.n()).done){o.next=10;break}if(!(r=n.value).getTrait(Yt)){o.next=8;break}return o.next=8,r;case 8:o.next=3;break;case 10:o.next=15;break;case 12:o.prev=12,o.t0=o.catch(1),e.e(o.t0);case 15:return o.prev=15,e.f(),o.finish(15);case 18:case"end":return o.stop()}}),Qt,null,[[1,12,15,18]])}function oe(t,e){var n=new Yt;n.name=e,t.addTrait(n)}function ie(t){return(ie="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ae(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"===typeof t)return ue(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ue(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function ue(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ce(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function le(t,e){return(le=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function se(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=pe(t);if(e){var o=pe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ye(this,n)}}function ye(t,e){return!e||"object"!==ie(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pe(t){return(pe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var he=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&le(t,e)}(i,t);var e,n,r,o=se(i);function i(){var t;ce(this,i);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=o.call.apply(o,[this].concat(n))).interval=2,t.coolDown=t.interval,t.emitters=[],t}return e=i,(n=[{key:"update",value:function(t,e,n){this.coolDown-=e.deltaTime,this.coolDown<=0&&(this.emit(t,e,n),this.coolDown=this.interval)}},{key:"emit",value:function(t,e,n){var r,o=ae(this.emitters);try{for(o.s();!(r=o.n()).done;)(0,r.value)(t,e,n)}catch(i){o.e(i)}finally{o.f()}}}])&&fe(e.prototype,n),r&&fe(e,r),i}(T);function ve(t){return function(t){if(Array.isArray(t))return de(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return de(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return de(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function de(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function be(t,e,n,r,o,i,a){try{var u=t[i](a),c=u.value}catch(f){return void n(f)}u.done?e(c):Promise.resolve(c).then(r,o)}function me(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){be(i,r,o,a,u,"next",t)}function u(t){be(i,r,o,a,u,"throw",t)}a(void 0)}))}}function we(t){return ge.apply(this,arguments)}function ge(){return(ge=me(o.a.mark((function t(e){var n,r,i;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=function(t,e,n){var o,i,a=null===(o=(i=e.entityFactory).bullet)||void 0===o?void 0:o.call(i);if(a){var u=ve(re(n.entities));if(!u.some((function(e){return r(e,t)<=30}))){var c=u.reduce((function(e,n){var o=r(e,t);return r(n,t)<o?n:e})).pos.x<t.pos.x?-1:1;a.pos.copy(t.pos),a.vel.x=80*c,n.entities.add(a),t.sounds.add("shoot")}}},t.next=3,zt("cannon",e);case 3:return n=t.sent,r=function(t,e){return Math.abs(t.pos.x-e.pos.x)},t.abrupt("return",(function(){var t=new E;t.audio=n;var e=new he;return e.interval=4,e.emitters.push(i),t.addTrait(e),t}));case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Se(t){return(Se="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Oe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ke(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function xe(t,e){return(xe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Te(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ee(t);if(e){var o=Ee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return je(this,n)}}function je(t,e){return!e||"object"!==Se(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ee(t){return(Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ae=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xe(t,e)}(i,t);var e,n,r,o=Te(i);function i(){var t;Oe(this,i);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=o.call.apply(o,[this].concat(n))).speed=-30,t.enabled=!0,t}return e=i,(n=[{key:"update",value:function(t){this.enabled&&(t.vel.x=this.speed)}},{key:"obstruct",value:function(t,e){e===x.left?this.speed=Math.abs(this.speed):e===x.right&&(this.speed=-Math.abs(this.speed))}}])&&ke(e.prototype,n),r&&ke(e,r),i}(T);function _e(t){return(_e="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Re(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ie(t,e){return(Ie=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ce(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=De(t);if(e){var o=De(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Me(this,n)}}function Me(t,e){return!e||"object"!==_e(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function De(t){return(De=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Le=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ie(t,e)}(i,t);var e,n,r,o=Ce(i);function i(){return Pe(this,i),o.apply(this,arguments)}return e=i,(n=[{key:"update",value:function(t,e,n){t.pos.x+=t.vel.x*e.deltaTime,n.tileCollider.checkX(t,e,n),t.pos.y+=t.vel.y*e.deltaTime,n.tileCollider.checkY(t,e,n),t.vel.y+=n.gravity*e.deltaTime}}])&&Re(e.prototype,n),r&&Re(e,r),i}(T);function ze(t){return(ze="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ne(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ue(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $e(t,e){return($e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Fe(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ge(t);if(e){var o=Ge(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ve(this,n)}}function Ve(t,e){return!e||"object"!==ze(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ge(t){return(Ge=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var qe=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$e(t,e)}(i,t);var e,n,r,o=Fe(i);function i(){var t;Ne(this,i);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=o.call.apply(o,[this].concat(n))).obstructs=!0,t}return e=i,(n=[{key:"obstruct",value:function(t,e,n){this.obstructs&&(e===x.bottom?(t.bounds.bottom=n.y1,t.vel.y=0):e===x.top?(t.bounds.top=n.y2,t.vel.y=0):e===x.right?(t.bounds.right=n.x1,t.vel.x=0):e===x.left&&(t.bounds.left=n.x2,t.vel.x=0))}}])&&Ue(e.prototype,n),r&&Ue(e,r),i}(T);function Ye(t,e,n,r,o,i,a){try{var u=t[i](a),c=u.value}catch(f){return void n(f)}u.done?e(c):Promise.resolve(c).then(r,o)}function Be(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Ye(i,r,o,a,u,"next",t)}function u(t){Ye(i,r,o,a,u,"throw",t)}a(void 0)}))}}function He(t){return(He="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ke(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function We(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xe(t,e,n){return e&&We(t.prototype,e),n&&We(t,n),t}function Je(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ze(t,e)}function Ze(t,e){return(Ze=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Qe(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=en(t);if(e){var o=en(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return tn(this,n)}}function tn(t,e){return!e||"object"!==He(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function en(t){return(en=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var nn,rn=function(t){Je(n,t);var e=Qe(n);function n(){return Ke(this,n),e.apply(this,arguments)}return Xe(n,[{key:"collides",value:function(t,e){var n,r;(null===(n=t.getTrait(et))||void 0===n?void 0:n.dead)||e.getTrait(ft)&&(e.vel.y>t.vel.y?(t.useTrait(Ae,(function(t){return t.speed=0})),t.useTrait(et,(function(t){return t.kill()}))):null===(r=e.getTrait(et))||void 0===r||r.kill())}}]),n}(T),on=function(t){Je(n,t);var e=Qe(n);function n(t,r){var o;return Ke(this,n),(o=e.call(this)).sprites=t,o.walkAnim=r,o.walk=o.addTrait(new Ae),o.behavior=o.addTrait(new rn),o.killable=o.addTrait(new et),o.solid=o.addTrait(new qe),o.physics=o.addTrait(new Le),o.size.set(16,16),o}return Xe(n,[{key:"draw",value:function(t){this.sprites.draw(this.routeAnim(),t,0,0)}},{key:"routeAnim",value:function(){return this.killable.dead?"flat":this.walkAnim(this.lifetime)}}]),n}(E);function an(){return un.apply(this,arguments)}function un(){return(un=Be(o.a.mark((function t(){var e,n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N("goomba");case 2:return e=t.sent,n=e.getAnimation("walk"),t.abrupt("return",(function(){return new on(e,n)}));case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function cn(t,e,n,r,o,i,a){try{var u=t[i](a),c=u.value}catch(f){return void n(f)}u.done?e(c):Promise.resolve(c).then(r,o)}function fn(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){cn(i,r,o,a,u,"next",t)}function u(t){cn(i,r,o,a,u,"throw",t)}a(void 0)}))}}function ln(t){return(ln="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function pn(t,e,n){return e&&yn(t.prototype,e),n&&yn(t,n),t}function hn(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vn(t,e)}function vn(t,e){return(vn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function dn(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=mn(t);if(e){var o=mn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return bn(this,n)}}function bn(t,e){return!e||"object"!==ln(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function mn(t){return(mn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){t[t.walking=0]="walking",t[t.hiding=1]="hiding",t[t.panic=2]="panic"}(nn||(nn={}));var wn=function(t){hn(n,t);var e=dn(n);function n(){var t;sn(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(t=e.call.apply(e,[this].concat(o))).state=nn.walking,t.hideTime=0,t.hideDuration=5,t.panicSpeed=300,t}return pn(n,[{key:"collides",value:function(t,e){var n;(null===(n=t.getTrait(et))||void 0===n?void 0:n.dead)||e.getTrait(ft)&&(e.vel.y>t.vel.y?this.handleStomp(t,e):this.handleNudge(t,e))}},{key:"handleStomp",value:function(t,e){this.state===nn.walking?this.hide(t):this.state===nn.hiding?(t.useTrait(et,(function(t){return t.kill()})),t.vel.set(100,-200),t.useTrait(qe,(function(t){return t.obstructs=!1}))):this.state===nn.panic&&this.hide(t)}},{key:"handleNudge",value:function(t,e){var n=function(){var t=e.getTrait(et);t&&t.kill()};if(this.state===nn.walking)n();else if(this.state===nn.hiding)this.panic(t,e);else if(this.state===nn.panic){var r=Math.sign(t.vel.x),o=Math.sign(t.pos.x-e.pos.x);0!==r&&r!==o&&n()}}},{key:"hide",value:function(t){var e=this;t.useTrait(Ae,(function(n){t.vel.x=0,n.enabled=!1,e.walkSpeed||(e.walkSpeed=n.speed),e.state=nn.hiding,e.hideTime=0}))}},{key:"unhide",value:function(t){var e=this;t.useTrait(Ae,(function(t){t.enabled=!0,null!=e.walkSpeed&&(t.speed=e.walkSpeed),e.state=nn.walking}))}},{key:"panic",value:function(t,e){var n=this;t.useTrait(Ae,(function(t){t.speed=n.panicSpeed*Math.sign(e.vel.x),t.enabled=!0})),this.state=nn.panic}},{key:"update",value:function(t,e){var n=e.deltaTime;this.state===nn.hiding&&(this.hideTime+=n,this.hideTime>this.hideDuration&&this.unhide(t))}}]),n}(T),gn=function(t){hn(n,t);var e=dn(n);function n(t){var r;return sn(this,n),(r=e.call(this)).sprites=t,r.walk=r.addTrait(new Ae),r.behavior=r.addTrait(new wn),r.killable=r.addTrait(new et),r.solid=r.addTrait(new qe),r.physics=r.addTrait(new Le),r.walkAnim=r.sprites.getAnimation("walk"),r.wakeAnim=r.sprites.getAnimation("wake"),r.size.set(16,16),r.offset.set(0,8),r}return pn(n,[{key:"draw",value:function(t){this.sprites.draw(this.routeAnim(),t,0,0,this.vel.x<0)}},{key:"routeAnim",value:function(){return this.behavior.state===nn.hiding?this.behavior.hideTime>3?this.wakeAnim(this.behavior.hideTime):"hiding":this.behavior.state===nn.panic?"hiding":this.walkAnim(this.lifetime)}}]),n}(E);function Sn(){return On.apply(this,arguments)}function On(){return(On=fn(o.a.mark((function t(){var e;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N("koopa");case 2:return e=t.sent,t.abrupt("return",(function(){return new gn(e)}));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function kn(t){return(kn="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function jn(t,e){return(jn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function En(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=_n(t);if(e){var o=_n(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return An(this,n)}}function An(t,e){return!e||"object"!==kn(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _n(t){return(_n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Pn=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jn(t,e)}(i,t);var e,n,r,o=En(i);function i(){var t;xn(this,i);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=o.call.apply(o,[this].concat(n))).duration=.3,t.velocity=200,t.engageTime=0,t.ready=0,t.requestTime=0,t.gracePeriod=.1,t.speedBoost=.3,t}return e=i,(n=[{key:"start",value:function(){this.requestTime=this.gracePeriod}},{key:"cancel",value:function(){this.engageTime=0,this.requestTime=0}},{key:"update",value:function(t,e){var n=e.deltaTime;this.requestTime>0&&(this.ready>0&&(t.sounds.add("jump"),this.engageTime=this.duration,this.requestTime=0),this.requestTime-=n),this.engageTime>0&&(t.vel.y=-(this.velocity+Math.abs(t.vel.x)*this.speedBoost),this.engageTime-=n),this.ready-=1}},{key:"obstruct",value:function(t,e){e===x.bottom?this.ready=1:e===x.top&&this.cancel()}},{key:"falling",get:function(){return this.ready<0}}])&&Tn(e.prototype,n),r&&Tn(e,r),i}(T);function Rn(t){return(Rn="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function In(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Cn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Mn(t,e){return(Mn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Dn(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=zn(t);if(e){var o=zn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ln(this,n)}}function Ln(t,e){return!e||"object"!==Rn(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zn(t){return(zn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Nn=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mn(t,e)}(i,t);var e,n,r,o=Dn(i);function i(){var t;In(this,i);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=o.call.apply(o,[this].concat(n))).dir=0,t.acceleration=400,t.distance=0,t.heading=1,t.dragFactor=2e-4,t.deceleration=300,t}return e=i,(n=[{key:"update",value:function(t,e){var n=e.deltaTime,r=Math.abs(t.vel.x);if(0!==this.dir){t.vel.x+=this.acceleration*this.dir*n;var o=t.getTrait(Pn);o?!1===o.falling&&(this.heading=this.dir):this.heading=this.dir}else if(0!==t.vel.x){var i=Math.min(r,this.deceleration*n);t.vel.x+=-Math.sign(t.vel.x)*i}else this.distance=0;var a=this.dragFactor*t.vel.x*r;t.vel.x-=a,this.distance+=r*n}}])&&Cn(e.prototype,n),r&&Cn(e,r),i}(T);function Un(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(c){o=!0,i=c}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"===typeof t)return $n(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $n(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Fn(t){return(Fn="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vn(t,e,n,r,o,i,a){try{var u=t[i](a),c=u.value}catch(f){return void n(f)}u.done?e(c):Promise.resolve(c).then(r,o)}function Gn(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Vn(i,r,o,a,u,"next",t)}function u(t){Vn(i,r,o,a,u,"throw",t)}a(void 0)}))}}function qn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Yn(t,e){return(Yn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Bn(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Kn(t);if(e){var o=Kn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Hn(this,n)}}function Hn(t,e){return!e||"object"!==Fn(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Kn(t){return(Kn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Wn=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yn(t,e)}(i,t);var e,n,r,o=Bn(i);function i(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(r=o.call(this)).sprites=t,r.audio=e,r.runAnimation=n,r.jump=r.addTrait(new Pn),r.go=r.addTrait(new Nn),r.stomper=r.addTrait(new ft),r.killable=r.addTrait(new et),r.solid=r.addTrait(new qe),r.physics=r.addTrait(new Le),r.size.set(14,16),r.go.dragFactor=.001,r.killable.removeAfter=0,r.setTurboState(!1),r}return e=i,(n=[{key:"resolveAnimationFrame",value:function(){return this.jump.falling?"jump":this.go.distance>0?this.vel.x>0&&this.go.dir<0||this.vel.x<0&&this.go.dir>0?"brake":this.runAnimation(this.go.distance):"idle"}},{key:"draw",value:function(t){this.sprites.draw(this.resolveAnimationFrame(),t,0,0,this.go.heading<0)}},{key:"setTurboState",value:function(t){this.go.dragFactor=t?2e-4:.001}}])&&qn(e.prototype,n),r&&qn(e,r),i}(E);function Xn(t){return Jn.apply(this,arguments)}function Jn(){return(Jn=Gn(o.a.mark((function t(e){var n,r,i,a,u;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([N("mario"),zt("mario",e)]);case 2:return n=t.sent,r=Un(n,2),i=r[0],a=r[1],u=i.getAnimation("run"),t.abrupt("return",(function(){return new Wn(i,a,u)}));case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Zn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(c){o=!0,i=c}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"===typeof t)return Qn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qn(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function tr(t){return(tr="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function er(t,e,n,r,o,i,a){try{var u=t[i](a),c=u.value}catch(f){return void n(f)}u.done?e(c):Promise.resolve(c).then(r,o)}function nr(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){er(i,r,o,a,u,"next",t)}function u(t){er(i,r,o,a,u,"throw",t)}a(void 0)}))}}function rr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function or(t,e){return(or=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ir(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ur(t);if(e){var o=ur(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ar(this,n)}}function ar(t,e){return!e||"object"!==tr(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ur(t){return(ur=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var cr=64,fr=64,lr=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&or(t,e)}(i,t);var e,n,r,o=ir(i);function i(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(r=o.call(this)).sprites=t,r.audio=e,r.animations=n,r.jump=r.addTrait(new Pn),r.go=r.addTrait(new Nn),r.stomper=r.addTrait(new ft),r.killable=r.addTrait(new et),r.solid=r.addTrait(new qe),r.physics=r.addTrait(new Le),r.size.set(cr,cr),r.go.dragFactor=.001,r.killable.removeAfter=0,r.setTurboState(!1),r}return e=i,(n=[{key:"resolveAnimationFrame",value:function(){return this.jump.falling?this.animations.jump(this.go.distance):this.go.distance>0?this.vel.x>0&&this.go.dir<0||this.vel.x<0&&this.go.dir>0?"brake":this.animations.run(this.go.distance):"idle"}},{key:"draw",value:function(t){this.sprites.draw(this.resolveAnimationFrame(),t,0,0,this.go.heading<0)}},{key:"setTurboState",value:function(t){this.go.dragFactor=t?2e-4:.001}}])&&rr(e.prototype,n),r&&rr(e,r),i}(E);function sr(t){return yr.apply(this,arguments)}function yr(){return(yr=nr(o.a.mark((function t(e){var n,r,i,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([N("takashi",cr,fr),zt("takashi",e)]);case 2:return n=t.sent,r=Zn(n,2),i=r[0],a=r[1],t.abrupt("return",(function(){return new lr(i,a,{run:i.getAnimation("run"),jump:i.getAnimation("jump")})}));case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function pr(t,e,n,r,o,i,a){try{var u=t[i](a),c=u.value}catch(f){return void n(f)}u.done?e(c):Promise.resolve(c).then(r,o)}function hr(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){pr(i,r,o,a,u,"next",t)}function u(t){pr(i,r,o,a,u,"throw",t)}a(void 0)}))}}function vr(t){return dr.apply(this,arguments)}function dr(){return(dr=hr(o.a.mark((function t(e){var n,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={},r=function(t){return function(e){n[t]=e}},t.next=4,Promise.all([Xn(e).then(r("mario")),sr(e).then(r("takashi")),an().then(r("goomba")),Sn().then(r("koopa")),At().then(r("bullet")),we(e).then(r("cannon"))]);case 4:return t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function br(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"===typeof t)return mr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mr(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function mr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function wr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var gr=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.receivers=new Set}var e,n,r;return e=t,(n=[{key:"addReceiver",value:function(t){this.receivers.add(t)}},{key:"dropReceiver",value:function(t){this.receivers.delete(t)}},{key:"route",value:function(t){var e,n=br(this.receivers);try{for(n.s();!(e=n.n()).done;)t(e.value)}catch(r){n.e(r)}finally{n.f()}}}])&&wr(e.prototype,n),r&&wr(e,r),t}();function Sr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Or=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.keyStates=new Map,this.keyListeners=new Map}var e,n,r;return e=t,(n=[{key:"addListener",value:function(t,e){this.keyListeners.set(t,e),this.keyStates.set(t,0)}},{key:"listenTo",value:function(t){var e=this;["keydown","keyup"].forEach((function(n){t.addEventListener(n,(function(t){e.handleEvent(t)}))}))}},{key:"handleEvent",value:function(t){if(!t.repeat){var e=this.keyListeners.get(t.code),n="keydown"===t.type?1:0;e&&(this.keyStates.set(t.code,n),e(n),t.preventDefault())}}}])&&Sr(e.prototype,n),r&&Sr(e,r),t}();function kr(t){var e=new Or,n=new gr,r=function(t,n){return t.forEach((function(t){return e.addListener(t,n)}))},o=0,i=0;return e.listenTo(t),r(["ArrowRight","KeyD"],(function(t){i=t,n.route((function(t){t.useTrait(Nn,(function(t){t.dir=i-o}))}))})),r(["ArrowLeft","KeyA"],(function(t){o=t,n.route((function(t){t.useTrait(Nn,(function(t){t.dir=i-o}))}))})),r(["KeyZ","Space","ArrowUp"],(function(t){t?n.route((function(t){t.useTrait(Pn,(function(t){return t.start()}))})):n.route((function(t){t.useTrait(Pn,(function(t){return t.cancel()}))}))})),r(["KeyX","KeyF"],(function(t){n.route((function(e){(e instanceof lr||e instanceof Wn)&&e.setTurboState(1===t)}))})),n}function xr(t){return function(e){e.fillStyle=t,e.fillRect(0,0,e.canvas.width,e.canvas.height)}}function Tr(t){return(Tr="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Er(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ar(t,e){return(Ar=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _r(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Rr(t);if(e){var o=Rr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Pr(this,n)}}function Pr(t,e){return!e||"object"!==Tr(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Rr(t){return(Rr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ir=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ar(t,e)}(i,t);var e,n,r,o=_r(i);function i(){var t;jr(this,i);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=o.call.apply(o,[this].concat(n))).totalTime=300,t.currentTime=t.totalTime,t.hurryTime=100,t}return e=i,(n=[{key:"update",value:function(t,e,n){var r=e.deltaTime;this.currentTime-=2*r,!0!==this.hurryEmitted&&this.currentTime<this.hurryTime&&(n.events.emit(i.EVENT_TIMER_HURRY),this.hurryEmitted=!0),!1!==this.hurryEmitted&&this.currentTime>this.hurryTime&&(n.events.emit(i.EVENT_TIMER_OK),this.hurryEmitted=!1)}}])&&Er(e.prototype,n),r&&Er(e,r),i}(T);function Cr(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"===typeof t)return Mr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mr(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function Mr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Dr(t,e){var n=t.size,r=2*t.size;return function(o){var i=function(t){var e,n=Cr(re(t.entities));try{for(n.s();!(e=n.n()).done;){var r=e.value.getTrait(Yt);if(r)return r}}catch(o){n.e(o)}finally{n.f()}}(e);i&&(t.print(i.name,o,16,n),t.print(String(i.score).padStart(6,"0"),o,16,r),t.print("@x"+String(i.coins).padStart(2,"0"),o,96,r)),t.print("WORLD",o,152,n),t.print(e.name,o,160,r);var a=function(t){var e,n=Cr(t.entities);try{for(n.s();!(e=n.n()).done;){var r=e.value.getTrait(Ir);if(r)return r}}catch(o){n.e(o)}finally{n.f()}}(e);a&&(t.print("TIME",o,208,n),t.print(String(Math.floor(a.currentTime)).padStart(3,"0"),o,216,r))}}function Lr(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"===typeof t)return zr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zr(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function zr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Nr(t,e){var n=t.size,r=document.createElement("canvas");r.width=32,r.height=32;var o=r.getContext("2d")||R("Canvas not supported");return function(i){var a,u=function(t){var e,n=Lr(re(t.entities));try{for(n.s();!(e=n.n()).done;){var r=e.value;if(r.getTrait(Yt))return r}}catch(o){n.e(o)}finally{n.f()}throw new Error("player not found")}(e);t.print("WORLD ".concat(e.name),i,12*n,12*n),o.clearRect(0,0,r.width,r.height),u.draw(o),i.drawImage(r,12*n,15*n);var c=String(null===(a=u.getTrait(Yt))||void 0===a?void 0:a.lives).padStart(2," ");t.print("x ".concat(c),i,16*n,16*n)}}function Ur(t,e){return function(n){var r=Math.floor(n.canvas.width/t.size),o=Math.floor(n.canvas.height/t.size),i=r/2-e.length/2,a=o/2;t.print(e,n,i*t.size,a*t.size)}}Ir.EVENT_TIMER_HURRY=Symbol("timer hurry"),Ir.EVENT_TIMER_OK=Symbol("timer ok");var $r=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pos=new w(0,0),this.size=new w(256,224)};function Fr(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"===typeof t)return Vr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Vr(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function Vr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Gr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var qr=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.entities=e}var e,n,r;return e=t,(n=[{key:"check",value:function(t){var e,n=Fr(this.entities);try{for(n.s();!(e=n.n()).done;){var r=e.value;t!==r&&t.bounds.overlaps(r.bounds)&&t.collides(r)}}catch(o){n.e(o)}finally{n.f()}}}])&&Gr(e.prototype,n),r&&Gr(e,r),t}();function Yr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Br=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"setPlayer",value:function(t){this.player=t}},{key:"playTheme",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=null===(t=this.player)||void 0===t?void 0:t.playTrack("main");n&&(n.playbackRate=e)}},{key:"playHurryTheme",value:function(){var t,e=this,n=null===(t=this.player)||void 0===t?void 0:t.playTrack("hurry");n&&(n.loop=!1,n.addEventListener("ended",(function(){return e.playTheme(1.3)}),{once:!0}))}},{key:"pause",value:function(){var t;null===(t=this.player)||void 0===t||t.pauseAll()}}])&&Yr(e.prototype,n),r&&Yr(e,r),t}();function Hr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Kr=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.layers=[]}var e,n,r;return e=t,(n=[{key:"draw",value:function(t,e){this.layers.forEach((function(n){n(t,e)}))}}])&&Hr(e.prototype,n),r&&Hr(e,r),t}();function Wr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Xr=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.listeners=[]}var e,n,r;return e=t,(n=[{key:"listen",value:function(t,e){this.listeners.push({name:t,callback:e})}},{key:"emit",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];this.listeners.filter((function(e){return e.name===t})).forEach((function(t){return t.callback.apply(t,n)}))}}])&&Wr(e.prototype,n),r&&Wr(e,r),t}();function Jr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Zr=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.comp=new Kr,this.events=new Xr}var e,n,r;return e=t,(n=[{key:"draw",value:function(t){this.comp.draw(t.videoContext,new $r)}},{key:"update",value:function(t){}},{key:"pause",value:function(){}}])&&Jr(e.prototype,n),r&&Jr(e,r),t}();function Qr(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"===typeof t)return to(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return to(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function to(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function eo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function no(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Zr.EVENT_COMPLETE=Symbol("scene complete");var ro=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16;eo(this,t),this.matrix=e,this.tileSize=n}var e,n,r;return e=t,(n=[{key:"toIndex",value:function(t){return Math.floor(t/this.tileSize)}},{key:"toIndexRange",value:o.a.mark((function t(e,n){var r,i;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=Math.ceil(n/this.tileSize)*this.tileSize,i=e;case 2:if(!(i<r)){t.next=8;break}return t.next=5,this.toIndex(i);case 5:i+=this.tileSize,t.next=2;break;case 8:case"end":return t.stop()}}),t,this)}))},{key:"getByIndex",value:function(t,e){var n=this.matrix.get(t,e);if(n)return{tile:n,x1:t*this.tileSize,x2:(t+1)*this.tileSize,y1:e*this.tileSize,y2:(e+1)*this.tileSize,indexX:t,indexY:e}}},{key:"searchByPosition",value:function(t,e){return this.getByIndex(this.toIndex(t),this.toIndex(e))}},{key:"searchByRange",value:o.a.mark((function t(e,n,r,i){var a,u,c,f,l,s,y;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=Qr(this.toIndexRange(e,n)),t.prev=1,a.s();case 3:if((u=a.n()).done){t.next=26;break}c=u.value,f=Qr(this.toIndexRange(r,i)),t.prev=6,f.s();case 8:if((l=f.n()).done){t.next=16;break}if(s=l.value,!(y=this.getByIndex(c,s))){t.next=14;break}return t.next=14,y;case 14:t.next=8;break;case 16:t.next=21;break;case 18:t.prev=18,t.t0=t.catch(6),f.e(t.t0);case 21:return t.prev=21,f.f(),t.finish(21);case 24:t.next=3;break;case 26:t.next=31;break;case 28:t.prev=28,t.t1=t.catch(1),a.e(t.t1);case 31:return t.prev=31,a.f(),t.finish(31);case 34:case"end":return t.stop()}}),t,this,[[1,28,31,34],[6,18,21,24]])}))}])&&no(e.prototype,n),r&&no(e,r),t}(),oo=function(t){var e=t.entity,n=t.match,r=t.resolver,o=e.getTrait(Yt);o&&(r.matrix.delete(n.indexX,n.indexY),o.addCoins(1))};function io(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"===typeof t)return ao(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ao(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function ao(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function uo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var co={ground:[function(t){var e=t.entity,n=t.match;e.vel.x>0?e.bounds.right>n.x1&&e.obstruct(x.right,n):e.vel.x<0&&e.bounds.left<n.x2&&e.obstruct(x.left,n)},function(t){var e=t.entity,n=t.match;e.vel.y>0?e.bounds.bottom>n.y1&&e.obstruct(x.bottom,n):e.vel.y<0&&e.bounds.top<n.y2&&e.obstruct(x.top,n)}],brick:[function(t){var e=t.entity,n=t.match;e.vel.x>0?e.bounds.right>n.x1&&e.obstruct(x.right,n):e.vel.x<0&&e.bounds.left<n.x2&&e.obstruct(x.left,n)},function(t){var e=t.entity,n=t.match,r=t.resolver,o=t.gameContext,i=t.level;if(e.vel.y>0)e.bounds.bottom>n.y1&&e.obstruct(x.bottom,n);else if(e.vel.y<0){if(e.getTrait(Yt)){r.matrix.delete(n.indexX,n.indexY);var a=o.entityFactory.goomba();a.vel.set(50,-400),a.pos.set(e.pos.x,n.y1),i.entities.add(a)}e.bounds.top<n.y2&&e.obstruct(x.top,n)}}],coin:[oo,oo]},fo=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.resolvers=[]}var e,n,r;return e=t,(n=[{key:"addGrid",value:function(t){this.resolvers.push(new ro(t))}},{key:"checkX",value:function(t,e,n){var r;if(t.vel.x>0)r=t.bounds.right;else{if(!(t.vel.x<0))return;r=t.bounds.left}var o,i=io(this.resolvers);try{for(i.s();!(o=i.n()).done;){var a,u=o.value,c=io(u.searchByRange(r,r,t.bounds.top,t.bounds.bottom));try{for(c.s();!(a=c.n()).done;){var f=a.value;this.handle(0,t,f,u,e,n)}}catch(l){c.e(l)}finally{c.f()}}}catch(l){i.e(l)}finally{i.f()}}},{key:"checkY",value:function(t,e,n){var r;if(t.vel.y>0)r=t.bounds.bottom;else{if(!(t.vel.y<0))return;r=t.bounds.top}var o,i=io(this.resolvers);try{for(i.s();!(o=i.n()).done;){var a,u=o.value,c=io(u.searchByRange(t.bounds.left,t.bounds.right,r,r));try{for(c.s();!(a=c.n()).done;){var f=a.value;this.handle(1,t,f,u,e,n)}}catch(l){c.e(l)}finally{c.f()}}}catch(l){i.e(l)}finally{i.f()}}},{key:"handle",value:function(t,e,n,r,o,i){var a,u,c={entity:e,match:n,resolver:r,gameContext:o,level:i};null===(a=co[n.tile.type])||void 0===a||null===(u=a[t])||void 0===u||u.call(a,c)}}])&&uo(e.prototype,n),r&&uo(e,r),t}();function lo(t){return(lo="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function so(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"===typeof t)return yo(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yo(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function yo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function po(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ho(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vo(t,e){return(vo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function bo(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=wo(t);if(e){var o=wo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return mo(this,n)}}function mo(t,e){return!e||"object"!==lo(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wo(t){return(wo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var go=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vo(t,e)}(i,t);var e,n,r,o=bo(i);function i(){var t;po(this,i);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=o.call.apply(o,[this].concat(n))).name="",t.entities=new Set,t.entityCollider=new qr(t.entities),t.tileCollider=new fo,t.music=new Br,t.camera=new $r,t.gravity=1500,t.totalTime=0,t}return e=i,(n=[{key:"update",value:function(t){var e=this;this.entities.forEach((function(n){n.update(t,e)})),this.entities.forEach((function(t){e.entityCollider.check(t)})),this.entities.forEach((function(t){t.finalize()})),this.totalTime+=t.deltaTime,function(t){var e,n=so(re(t.entities));try{for(n.s();!(e=n.n()).done;){var r=e.value;t.camera.pos.x=Math.max(0,r.pos.x-100)}}catch(o){n.e(o)}finally{n.f()}}(this)}},{key:"draw",value:function(t){this.comp.draw(t.videoContext,this.camera)}},{key:"pause",value:function(){this.music.pause()}}])&&ho(e.prototype,n),r&&ho(e,r),i}(Zr);function So(t,e,n,r,o,i,a){try{var u=t[i](a),c=u.value}catch(f){return void n(f)}u.done?e(c):Promise.resolve(c).then(r,o)}function Oo(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){So(i,r,o,a,u,"next",t)}function u(t){So(i,r,o,a,u,"throw",t)}a(void 0)}))}}function ko(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(c){o=!0,i=c}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||jo(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xo(t){return function(t){if(Array.isArray(t))return Eo(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||jo(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function To(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=jo(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function jo(t,e){if(t){if("string"===typeof t)return Eo(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Eo(t,e):void 0}}function Eo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ao(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}go.EVENT_TRIGGER=Symbol("trigger");var _o=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",Po=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sprites=e,this.size=n}var e,n,r;return e=t,(n=[{key:"print",value:function(t,e,n,r){var o,i=To(xo(t).entries());try{for(i.s();!(o=i.n()).done;){var a=ko(o.value,2),u=a[0],c=a[1];this.sprites.draw(c,e,n+u*this.size,r)}}catch(f){i.e(f)}finally{i.f()}}}])&&Ao(e.prototype,n),r&&Ao(e,r),t}();function Ro(){return Io.apply(this,arguments)}function Io(){return(Io=Oo(o.a.mark((function t(){var e,n,r,i,a,u,c,f,l,s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_("images/font.png");case 2:e=t.sent,n=new C(e,8,8),8,r=e.width,i=To(xo(_o).entries());try{for(i.s();!(a=i.n()).done;)u=ko(a.value,2),c=u[0],f=u[1],l=8*c%r,s=8*Math.floor(8*c/r),n.define(f,l,s,8,8)}catch(o){i.e(o)}finally{i.f()}return t.abrupt("return",new Po(n,8));case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Co(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(c){o=!0,i=c}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||Mo(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mo(t,e){if(t){if("string"===typeof t)return Do(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Do(t,e):void 0}}function Do(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Lo(t,e,n){var r=new ro(e),o=document.createElement("canvas");o.width=272,o.height=240;var i=o.getContext("2d")||R("Canvas not supported");function a(r,a){i.clearRect(0,0,o.width,o.height);var u,c=function(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=Mo(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}(e.itemsInRange(r,0,a,o.height/16));try{for(c.s();!(u=c.n()).done;){var f=Co(u.value,3),l=f[0],s=f[1],y=f[2];l.name&&(n.animations.has(l.name)?n.drawAnimation(l.name,i,s-r,y,t.totalTime):n.drawTile(l.name,i,s-r,y))}}catch(p){c.e(p)}finally{c.f()}}return function(t,e){var n=r.toIndex(e.size.x),i=r.toIndex(e.pos.x);a(i,i+n),t.drawImage(o,-e.pos.x%16,-e.pos.y)}}function zo(t){return(zo="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function No(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"===typeof t)return Uo(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Uo(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function Uo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function $o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Fo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Vo(t,e){return(Vo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Go(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Yo(t);if(e){var o=Yo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qo(this,n)}}function qo(t,e){return!e||"object"!==zo(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yo(t){return(Yo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Bo=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vo(t,e)}(i,t);var e,n,r,o=Go(i);function i(){var t;$o(this,i);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=o.call.apply(o,[this].concat(n))).touches=new Set,t.conditions=[],t}return e=i,(n=[{key:"collides",value:function(t,e){this.touches.add(e)}},{key:"update",value:function(t,e,n){if(this.touches.size>0){var r,o=No(this.conditions);try{for(o.s();!(r=o.n()).done;)(0,r.value)(t,this.touches,e,n)}catch(i){o.e(i)}finally{o.f()}this.touches.clear()}}}])&&Fo(e.prototype,n),r&&Fo(e,r),i}(T);function Ho(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"===typeof t)return Ko(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ko(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function Ko(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Wo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Xo=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tracks=new Map}var e,n,r;return e=t,(n=[{key:"addTrack",value:function(t,e){var n=new Audio;n.loop=!0,n.src=e,this.tracks.set(t,n)}},{key:"playTrack",value:function(t){this.pauseAll();var e=this.tracks.get(t);return null===e||void 0===e||e.play(),e}},{key:"pauseAll",value:function(){var t,e=Ho(this.tracks.values());try{for(e.s();!(t=e.n()).done;)t.value.pause()}catch(n){e.e(n)}finally{e.f()}}}])&&Wo(e.prototype,n),r&&Wo(e,r),t}();function Jo(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(c){o=!0,i=c}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"===typeof t)return Zo(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zo(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Qo(t,e,n,r,o,i,a){try{var u=t[i](a),c=u.value}catch(f){return void n(f)}u.done?e(c):Promise.resolve(c).then(r,o)}function ti(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Qo(i,r,o,a,u,"next",t)}function u(t){Qo(i,r,o,a,u,"throw",t)}a(void 0)}))}}function ei(t){return ni.apply(this,arguments)}function ni(){return(ni=ti(o.a.mark((function t(e){var n,r,i,a,u,c,f;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P("/music/".concat(e,".json"));case 2:for(n=t.sent,r=new Xo,i=0,a=Object.entries(n);i<a.length;i++)u=Jo(a[i],2),c=u[0],f=u[1],r.addTrack(c,f.url);return t.abrupt("return",r);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var ri=o.a.mark(wi),oi=o.a.mark(Si),ii=o.a.mark(Oi);function ai(t,e,n,r,o,i,a){try{var u=t[i](a),c=u.value}catch(f){return void n(f)}u.done?e(c):Promise.resolve(c).then(r,o)}function ui(t){return function(t){if(Array.isArray(t))return si(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||li(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ci(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(c){o=!0,i=c}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||li(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fi(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=li(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function li(t,e){if(t){if("string"===typeof t)return si(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?si(t,e):void 0}}function si(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function yi(t){return P("/sprites/patterns/".concat(t,".json"))}function pi(t){var e=function(){var t=new E;return t.addTrait(new Ir),t}();t.entities.add(e),t.events.listen(Ir.EVENT_TIMER_OK,(function(){t.music.playTheme()})),t.events.listen(Ir.EVENT_TIMER_HURRY,(function(){t.music.playHurryTheme()}))}function hi(t,e,n,r){var o,i=fi(t.layers);try{for(i.s();!(o=i.n()).done;){var a=mi(o.value.tiles,r),u=Lo(e,a,n);e.comp.layers.push(u),e.tileCollider.addGrid(a)}}catch(c){i.e(c)}finally{i.f()}}function vi(t,e,n){t.entities.forEach((function(t){var r=t.name,o=ci(t.pos,2),i=o[0],a=o[1],u=n[r];if(!u)throw new Error('Could not find factory function for entity "'.concat(r,'"'));var c=u();c.pos.set(i,a),e.entities.add(c)}));var r=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64,r=document.createElement("canvas");r.width=e,r.height=n;var o=r.getContext("2d")||R("Canvas not supported");return function(i,a){t.forEach((function(t){o.clearRect(0,0,e,n),t.draw(o),i.drawImage(r,t.pos.x-a.pos.x,t.pos.y-a.pos.y)}))}}(e.entities);e.comp.layers.push(r)}function di(t,e){if(t.triggers){var n,r=fi(t.triggers);try{var o=function(){var t,r=n.value,o=new Bo;o.conditions.push((function(t,e,n,o){o.events.emit(go.EVENT_TRIGGER,r,t,e)}));var i=new E;i.addTrait(o),(t=i.pos).set.apply(t,ui(r.pos)),i.size.set(64,64),e.entities.add(i)};for(r.s();!(n=r.n()).done;)o()}catch(i){r.e(i)}finally{r.f()}}}function bi(t){return function(){var e,n=(e=o.a.mark((function e(n){var r,i,a,u,c,f,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P("levels/".concat(n,".json"));case 2:return r=e.sent,e.next=5,Promise.all([N(r.spriteSheet),ei(r.musicSheet),yi(r.patternSheet)]);case 5:return i=e.sent,a=ci(i,3),u=a[0],c=a[1],f=a[2],(l=new go).name=n,l.music.setPlayer(c),hi(r,l,u,f),vi(r,l,t),di(r,l),pi(l),e.abrupt("return",l);case 18:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(t){ai(i,r,o,a,u,"next",t)}function u(t){ai(i,r,o,a,u,"throw",t)}a(void 0)}))});return function(t){return n.apply(this,arguments)}}()}function mi(t,e){var n,r=new g,o=fi(Oi(t,e));try{for(o.s();!(n=o.n()).done;){var i=n.value,a=i.x,u=i.y,c=i.tile;r.set(a,u,c)}}catch(f){o.e(f)}finally{o.f()}return r}function wi(t,e,n,r){var i,a,u,c;return o.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:i=t+e,a=n+r,u=t;case 3:if(!(u<i)){o.next=14;break}c=n;case 5:if(!(c<a)){o.next=11;break}return o.next=8,{x:u,y:c};case 8:c++,o.next=5;break;case 11:u++,o.next=3;break;case 14:case"end":return o.stop()}}),ri)}function gi(t){if(4===t.length){var e=ci(t,4);return wi(e[0],e[1],e[2],e[3])}if(3===t.length){var n=ci(t,3);return wi(n[0],n[1],n[2],1)}if(2===t.length){var r=ci(t,2);return wi(r[0],1,r[1],1)}throw new Error("Invalid range of length ".concat(t.length))}function Si(t){var e,n,r;return o.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:e=fi(t),o.prev=1,e.s();case 3:if((n=e.n()).done){o.next=8;break}return r=n.value,o.delegateYield(gi(r),"t0",6);case 6:o.next=3;break;case 8:o.next=13;break;case 10:o.prev=10,o.t1=o.catch(1),e.e(o.t1);case 13:return o.prev=13,e.f(),o.finish(13);case 16:case"end":return o.stop()}}),oi,null,[[1,10,13,16]])}function Oi(t,e){var n,r;return o.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return r=function(t,i,a){var u,c,f,l,s,y,p,h,v,d,b;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:u=fi(t),n.prev=1,u.s();case 3:if((c=u.n()).done){n.next=37;break}f=c.value,l=fi(Si(f.ranges)),n.prev=6,l.s();case 8:if((s=l.n()).done){n.next=27;break}if(y=s.value,p=y.x,h=y.y,v=p+i,d=h+a,!f.pattern){n.next=19;break}if(e[f.pattern]){n.next=15;break}throw new Error("pattern ".concat(f.pattern," not found"));case 15:return b=e[f.pattern].tiles,n.delegateYield(r(b,v,d),"t0",17);case 17:n.next=25;break;case 19:if(!f.name){n.next=24;break}return n.next=22,{tile:f,x:v,y:d};case 22:n.next=25;break;case 24:throw new Error("Tile does not have a name or a pattern: ".concat(JSON.stringify(f)));case 25:n.next=8;break;case 27:n.next=32;break;case 29:n.prev=29,n.t1=n.catch(6),l.e(n.t1);case 32:return n.prev=32,l.f(),n.finish(32);case 35:n.next=3;break;case 37:n.next=42;break;case 39:n.prev=39,n.t2=n.catch(1),u.e(n.t2);case 42:return n.prev=42,u.f(),n.finish(42);case 45:case"end":return n.stop()}}),n,null,[[1,39,42,45],[6,29,32,35]])},n=o.a.mark(r),i.delegateYield(r(t,0,0),"t0",3);case 3:case"end":return i.stop()}}),ii)}function ki(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var xi=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sceneIndex=-1,this.scenes=[]}var e,n,r;return e=t,(n=[{key:"addScene",value:function(t){var e=this;this.scenes.push(t),t.events.listen(Zr.EVENT_COMPLETE,(function(){e.runNext()}))}},{key:"runNext",value:function(){var t;null===(t=this.currentScene)||void 0===t||t.pause(),this.sceneIndex+=1}},{key:"update",value:function(t){var e,n;null===(e=this.currentScene)||void 0===e||e.update(t),null===(n=this.currentScene)||void 0===n||n.draw(t)}},{key:"currentScene",get:function(){return this.scenes[this.sceneIndex]}}])&&ki(e.prototype,n),r&&ki(e,r),t}();function Ti(t){return(Ti="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ji(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ei(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ai(t,e){return(Ai=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _i(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ri(t);if(e){var o=Ri(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Pi(this,n)}}function Pi(t,e){return!e||"object"!==Ti(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ri(t){return(Ri=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ii=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ai(t,e)}(i,t);var e,n,r,o=_i(i);function i(){var t;ji(this,i);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=o.call.apply(o,[this].concat(n))).countDown=2,t}return e=i,(n=[{key:"update",value:function(t){this.countDown-=t.deltaTime,this.countDown<=0&&this.events.emit(Zr.EVENT_COMPLETE)}}])&&Ei(e.prototype,n),r&&Ei(e,r),i}(Zr);function Ci(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Di=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/60;Ci(this,t),this.deltaTime=n,this.accumulatedTime=0,this.update=function(t){},this.updateProxy=function(t){if(null!=e.lastTime)for(e.accumulatedTime+=(t-e.lastTime)/1e3,e.accumulatedTime=Math.min(e.accumulatedTime,1);e.accumulatedTime>e.deltaTime;)e.update(e.deltaTime),e.accumulatedTime-=e.deltaTime;e.lastTime=t,e.enqueue()}}var e,n,r;return e=t,(n=[{key:"start",value:function(){this.enqueue()}},{key:"enqueue",value:function(){requestAnimationFrame(this.updateProxy)}}])&&Mi(e.prototype,n),r&&Mi(e,r),t}();function Li(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=Ni(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function zi(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(c){o=!0,i=c}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||Ni(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ni(t,e){if(t){if("string"===typeof t)return Ui(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ui(t,e):void 0}}function Ui(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function $i(t,e,n,r,o,i,a){try{var u=t[i](a),c=u.value}catch(f){return void n(f)}u.done?e(c):Promise.resolve(c).then(r,o)}function Fi(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){$i(i,r,o,a,u,"next",t)}function u(t){$i(i,r,o,a,u,"throw",t)}a(void 0)}))}}function Vi(){return(Vi=Fi(o.a.mark((function t(e){var n,r,i,a,u,c,f,l,s,y,p,h,v;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return h=function(){return(h=Fi(o.a.mark((function t(e){var n,r,i,a,u,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=new Zr).comp.layers.push(xr("black")),n.comp.layers.push(Ur(f,"LOADING ".concat(e,"..."))),s.addScene(n),s.runNext(),t.next=7,new Promise((function(t){return setTimeout(t,500)}));case 7:return t.next=9,l(e);case 9:(r=t.sent).events.listen(go.EVENT_TRIGGER,(function(t,e,n){if("goto"===t.type){var r,o=Li(n);try{for(o.s();!(r=o.n()).done;){if(r.value.getTrait(Yt))return void p(t.name)}}catch(i){o.e(i)}finally{o.f()}}})),i=Nr(f,r),a=Dr(f,r),y.pos.set(0,1),y.vel.set(0,0),r.entities.add(y),u=ne(y),r.entities.add(u),(c=new Ii).comp.layers.push(xr("black")),c.comp.layers.push(a),c.comp.layers.push(i),s.addScene(c),r.comp.layers.push(a),s.addScene(r),s.runNext();case 26:case"end":return t.stop()}}),t)})))).apply(this,arguments)},p=function(t){return h.apply(this,arguments)},(r=e.getContext("2d")||R("Canvas not supported")).imageSmoothingEnabled=!1,i=new AudioContext,t.next=7,Promise.all([vr(i),Ro()]);case 7:a=t.sent,u=zi(a,2),c=u[0],f=u[1],l=bi(c),s=new xi,oe(y=(null===(n=c.takashi)||void 0===n?void 0:n.call(c))||R("where takashi tho"),"TAKASHI"),kr(window).addReceiver(y),(v=new Di).update=function(t){if(document.hasFocus()){var e={deltaTime:t,audioContext:i,entityFactory:c,videoContext:r};s.update(e)}},v.start(),p("debug-progression");case 21:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Gi=document.getElementById("screen");Gi instanceof HTMLCanvasElement?function(t){return Vi.apply(this,arguments)}(Gi).catch(console.error):console.warn("Canvas not found")},function(t,e,n){t.exports=n(4)},function(t,e,n){var r=function(t){"use strict";var e=Object.prototype,n=e.hasOwnProperty,r="function"===typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function u(t,e,n,r){var o=e&&e.prototype instanceof l?e:l,i=Object.create(o.prototype),a=new O(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return x()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var u=w(a,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=c(t,e,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===f)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}(t,n,a),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(r){return{type:"throw",arg:r}}}t.wrap=u;var f={};function l(){}function s(){}function y(){}var p={};p[o]=function(){return this};var h=Object.getPrototypeOf,v=h&&h(h(k([])));v&&v!==e&&n.call(v,o)&&(p=v);var d=y.prototype=l.prototype=Object.create(p);function b(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function m(t,e){var r;this._invoke=function(o,i){function a(){return new e((function(r,a){!function r(o,i,a,u){var f=c(t[o],t,i);if("throw"!==f.type){var l=f.arg,s=l.value;return s&&"object"===typeof s&&n.call(s,"__await")?e.resolve(s.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(s).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,u)}))}u(f.arg)}(o,i,r,a)}))}return r=r?r.then(a,a):a()}}function w(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return f;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,f;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function g(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(g,this),this.reset(!0)}function k(t){if(t){var e=t[o];if(e)return e.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return s.prototype=d.constructor=y,y.constructor=s,y[a]=s.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===s||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,a in t||(t[a]="GeneratorFunction")),t.prototype=Object.create(d),t},t.awrap=function(t){return{__await:t}},b(m.prototype),m.prototype[i]=function(){return this},t.AsyncIterator=m,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new m(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(d),d[a]="Generator",d[o]=function(){return this},d.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=k,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),S(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;S(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:k(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},t}(t.exports);try{regeneratorRuntime=r}catch(o){Function("r","regeneratorRuntime = r")(r)}}]]);